---
title: "Project 1: Co-Medians"
subtitle: "Project 1 Proposal"
authors: "Ellen Zhang, Amber Potter, Helen Chen, Morgan Bernstein"
format: html
editor: visual
---

```{r}
#| label: load-pkgs
#| message: false

library(tidyverse)
library(dplyr)
library(tidytuesdayR)
library(lubridate)
```

# Dataset

```{r}
#| label: load-data
#| message: false

tuesdata <- tidytuesdayR::tt_load('2022-06-07')

pride_aggregates <- tuesdata$pride_aggregates
fortune_aggregates <- tuesdata$fortune_aggregates
static_list <- tuesdata$static_list
pride_sponsors <- tuesdata$pride_sponsors
corp_by_politician <- tuesdata$corp_by_politician
contribution_data_all_states <- tuesdata$contribution_data_all_states

company_contribution_all_q2 <- contribution_data_all_states %>%
  filter(!is.na(Company), !is.na(Date)) %>%
  mutate(year = year(ymd(Date)),
         pride_or_not = case_when(`Pride?` == TRUE ~ "Pride",
                                TRUE ~ "Anti-LGBTQ+")) %>%
  group_by( pride_or_not, year) %>%
  summarize(total_contribution = sum(Amount)) %>%

unique(contribution_data_all_states$`Pride?`)


#unique(contribution_data_all_states$Date == NA)

#glimpse(pride_aggregates)
#glimpse(fortune_aggregates)
#glimpse(static_list)
#glimpse(pride_sponsors)
#glimpse(corp_by_politician)
#glimpse(contribution_data_all_states)
```

```{r}
#Source: Politico (https://www.politico.com/2020-election/results/president/)
#by how they voted in 2020 presidential election

blue_states <- c("NJ", "CO", "AZ", "GA", "WA", "OR", "CA", "NV", "NM", "MN", 
                 "HI", "MI", "IL", "WI", "VA", "MD", "PA", "NY", "VT", "NH", 
                 "MA", "ME", "CT", "RI", "DE", "DC")


contribution_data_all_states %>% 
  filter(!is.na(Company)) %>%
  mutate(year = year(ymd(Date))) %>%
  filter(year == 2021) %>%
  mutate(party = ifelse(State %in% blue_states, "Blue", "Red")) %>%
  group_by(State) %>%
  summarise(sum_of_contributions = sum(Amount))


unique(contribution_data_all_states$State)
```

The datasets we are using are from TidyTuesday and come from the website Data For Progress. The first dataset is pride_aggregates, which has 31 observations of 4 variables. It has information on companies that are pride sponsors but also contribute to anti-LGBTQ+ corporations. The variables given are the company name, total amount contributed to anti-LGBTQ+ corporations, number of politicians contributed to, and number of states where they made contributions. The second dataset, fortune_aggregates, has 117 observations of the same 4 variables but this time looking at Fortune 500 pride sponsors who donate to anti-LGBTQ+ campaigns. The third dataset is static_list, containing information on 126 companies and whether they donated to pride, HRC business pledge, dollar amount contributed across states, number of politicians contributed to, and number of states where they made contributions. Lastly, the largest dataset is contribution_data_all_states with 13210 observations of companies along with if they were a pride and sponsor match, if they were a pride event sponsor, HRC business pledge, donor name, politician donated to, state donated to, amount in USD of donation, date, citation, donor type, comments, and an archive.

#color by HRC business pledge, x axis is contributions, y is the company

```{r}
unique(static_list$Company)

static_list %>%  
  filter(!is.na(Company), !is.na(`HRC Business Pledge`)) %>%
  select(Company, `Amount Contributed Across States`, `HRC Business Pledge`) %>%
  group_by(Company) %>%
  summarise(total_amount = sum(`Amount Contributed Across States`)) %>%
  arrange(desc(total_amount)) %>%
  slice_head(n = 10)
  
```

```{r making_year_variable}
contribution_data_all_states |> 
  mutate(year = year(ymd(Date))) |> 
  distinct(year) #years go 2013-2021
```

# Questions

The first question we want to answer using this dataset is which companies donate the most money in contributions to anti-LGBTQ+ campaigns, and which of these companies have an HRC pledge in place? The Human Rights Campaign (HRC) business pledge is a commitment for companies to show their clear opposition to harmful legislation aimed at restricting the access of LGBTQ people in society and the workplace.

Source: https://www.hrc.org/resources/business-statement-on-anti-lgbtq-state-legislation

Our second question involves the dollar amount of contributions made to anti-LGBTQ+ campaigns vs the dollar amount of contributions to pride campaigns by the hypocritical companies who contribute to both anti-LGBTQ+ and pro-pride campaigns. Specifically, what is the magnitude of difference in contributions to pro- and anti-LGBTQ+ campaigns made by these companies over the years 2013 to 2022?

# Analysis plan

For the first question, we plan to visualize the answer by creating a bar chart of the dollar amount of contributions to anti-LGBTQ+ campaigns made by the top 10 (tentative) companies in US dollars. We plan to color the bar of the company based on whether or not they have an HRC pledge in place. Variables used: Company, Contribution to anti-LGBTQ+ (USD), Existence of an HRC pledge.

For the second question, we plan to use a line plot that displays the dollar amount of contributions made to both anti-LGBTQ+ campaigns and Pride campaigns by companies who contribute to both over the years of 2013 to 2022. Variables used: Contribution to anti-LGBTQ+ campaigns (USD), Contribution to Pride campaigns (USD), and Year.
